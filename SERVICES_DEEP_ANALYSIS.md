# üîç CERES Services Deep Analysis ‚Äî Optimization Audit

**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑ | **–¶–µ–ª—å:** –í—ã—è–≤–∏—Ç—å —á—Ç–æ –Ω—É–∂–Ω–æ, –∑–∞–º–µ–Ω–∏—Ç—å, —É–¥–∞–ª–∏—Ç—å

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –í–´–Ø–í–õ–ï–ù–´

### 1Ô∏è‚É£ **–î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï: Jaeger + Tempo + OTEL Collector**

**–°—Ç–∞—Ç—É—Å:** üî¥ –ö–û–ù–§–õ–ò–ö–¢!

–°–µ–π—á–∞—Å –≤ observability.yml:
- **Jaeger** (–≤—Å–µ-–≤-–æ–¥–Ω–æ–º —Ç—Ä–µ–π—Å–∏–Ω–≥) ‚Üí –ø–æ—Ä—Ç—ã 16686, 14268, 14250
- **Tempo** (Grafana —Ç—Ä–µ–π—Å–∏–Ω–≥) ‚Üí –ø–æ—Ä—Ç—ã 3200, 4317, 4318
- **OTEL Collector** (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π) ‚Üí –ø–æ—Ä—Ç—ã 4317, 4318, 9411, 14250

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ü–æ—Ä—Ç—ã 4317/4318 —Å–æ–≤–ø–∞–¥–∞—é—Ç –º–µ–∂–¥—É Tempo –∏ OTEL
- ‚ùå –ü–æ—Ä—Ç—ã 14250 —Å–æ–≤–ø–∞–¥–∞—é—Ç –º–µ–∂–¥—É Jaeger –∏ OTEL
- ‚ùå –í—Å–µ —Ç—Ä–∏ —Å–æ–±–∏—Ä–∞—é—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (3 –ì–ë RAM –≤–º–µ—Å—Ç–æ 500 MB)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å **—Ç–æ–ª—å–∫–æ Tempo** (—Ä–æ–¥–Ω–æ–π Grafana, –ø—Ä–æ—Å—Ç–æ–π, 512 MB)
- ‚ùå –£–¥–∞–ª–∏—Ç—å Jaeger (–¥—É–±–ª–∏—Ä—É–µ—Ç Tempo)
- ‚ùå –£–¥–∞–ª–∏—Ç—å OTEL Collector (–Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–ª–∏ –Ω–µ Tempo)

---

### 2Ô∏è‚É£ **–ò–ó–ë–´–¢–û–ß–ù–û–°–¢–¨: Loki –í MONITORING.YML**

**–°—Ç–∞—Ç—É—Å:** üü° –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –†–ê–ó–ú–ï–©–ï–ù–ò–ï

`monitoring.yml` —Å–æ–¥–µ—Ä–∂–∏—Ç:
- Prometheus, Grafana, cAdvisor, exporters
- **–∏ —Ç–∞–∫–∂–µ Loki** (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Loki –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ (–Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É)
- Loggi –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `observability.yml`, –∞ –Ω–µ –≤ monitoring
- –°–µ–π—á–∞—Å –Ω–µ–ª—å–∑—è –≤–∫–ª—é—á–∏—Ç—å monitoring –ë–ï–ó –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å Loki –≤ `observability.yml`
- ‚úÖ Monitoring –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Å—Ç—ã–º (—Ç–æ–ª—å–∫–æ –º–µ—Ç—Ä–∏–∫–∏)
- ‚úÖ Observability = Loki + Promtail + Tempo (–∏–ª–∏ Jaeger)

---

### 3Ô∏è‚É£ **–ù–ï–ü–û–õ–ù–û–¢–ê: Promtail –û–¢–°–£–¢–°–¢–í–£–ï–¢**

**–°—Ç–∞—Ç—É—Å:** üî¥ –ö–†–ò–¢–ò–ß–ù–û

–í observability.yml –µ—Å—Ç—å:
- Jaeger ‚úÖ
- Tempo ‚úÖ
- OTEL Collector ‚úÖ

–ù–æ –ù–ï–¢:
- **Promtail** ‚ùå (–∞–≥–µ–Ω—Ç —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ –¥–ª—è Loki)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Loki –≤–∫–ª—é—á–µ–Ω –≤ monitoring.yml, –Ω–æ –±–µ–∑ Promtail –ª–æ–≥–∏ –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—É-–Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∞—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Promtail –≤ observability.yml
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä –ª–æ–≥–æ–≤ —Å–æ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Loki

---

### 4Ô∏è‚É£ **–ü–ï–†–ï–ö–†–´–¢–ò–ï: Prometheus + cAdvisor**

**–°—Ç–∞—Ç—É—Å:** üü° –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï

–°–µ–π—á–∞—Å:
- **Prometheus** ‚Üí —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (TSDB)
- **cAdvisor** ‚Üí —Ç–æ–∂–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Prometheus —É–∂–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ exporters (postgres_exporter, redis_exporter)
- cAdvisor –¥—É–±–ª–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å **Prometheus** (–æ—Å–Ω–æ–≤–Ω–æ–π TSDB)
- ‚ö†Ô∏è cAdvisor –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å, –Ω–æ –Ω—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, —á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª
- ‚ùå –ò–ª–∏ —É–¥–∞–ª–∏—Ç—å cAdvisor –µ—Å–ª–∏ Node Exporter –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

---

### 5Ô∏è‚É£ **–û–¢–°–£–¢–°–¢–í–ò–ï: Alertmanager**

**–°—Ç–∞—Ç—É—Å:** üü° –ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨

Prometheus –≤–∫–ª—é—á—ë–Ω, –Ω–æ –±–µ–∑:
- **Alertmanager** (–æ–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤)
- **Alert Rules** (–ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è alerts)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è, –Ω–æ –∞–ª–µ—Ä—Ç—ã –Ω–∏–∫–æ–º—É –Ω–µ –∏–¥—É—Ç
- –°–∏—Å—Ç–µ–º–∞ —Å–ª–µ–ø–∞—è (–Ω–µ –≤–∏–¥–∏—Ç –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ —É–ø–∞–¥—ë—Ç)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Alertmanager –≤ monitoring.yml
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ (alert-rules.yml)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å email/Slack/—Ç–µ–ª–µ–≥—Ä–∞–º

---

### 6Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê: Prometheus+Grafana+Loki –í–°–ï –í –†–ê–ó–ù–´–• –ú–û–î–£–õ–Ø–•**

**–°—Ç–∞—Ç—É—Å:** üü° –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–ê–Ø –ü–£–¢–ê–ù–ò–¶–ê

–°–µ–π—á–∞—Å:
- **monitoring.yml**: Prometheus, Grafana, cAdvisor, exporters, **–∏ Loki**
- **observability.yml**: Jaeger, Tempo, OTEL (–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å Loki?)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –≥–¥–µ
- Grafana –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ Prometheus (–≤ —Ç–æ–º –∂–µ —Ñ–∞–π–ª–µ) ‚úÖ
- –ù–æ Grafana —Ç–∞–∫–∂–µ –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ Loki (—Ç–æ–∂–µ –≤ —Ç–æ–º –∂–µ —Ñ–∞–π–ª–µ) ‚úÖ
- –ù–æ Loki –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∞, –∞ Prometheus –≤–∫–ª—é—á–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```
monitoring.yml     ‚Üí Prometheus, Grafana, exporters, cAdvisor, Alertmanager
observability.yml  ‚Üí Loki, Promtail, Tempo (–≤—ã–±—Ä–∞—Ç—å Jaeger –∏–ª–∏ Tempo)
```

---

## üìä –¢–ê–ë–õ–ò–¶–ê –ê–ù–ê–õ–ò–ó–ê –û–°–ù–û–í–ù–´–• –°–ï–†–í–ò–°–û–í

### CORE SERVICES (–ï—Å—Ç—å, –Ω—É–∂–Ω—ã, –û–ö)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ó–∞–º–µ–Ω–∞? |
|--------|-----------|--------|-------|---------|
| PostgreSQL | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚ùå –ù–µ—Ç |
| Redis | –ö—ç—à, –æ—á–µ—Ä–µ–¥–∏ (Nextcloud, etc) | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚ö†Ô∏è Memcached (–Ω–µ –Ω—É–∂–µ–Ω) |

---

### APPS SERVICES (–ï—Å—Ç—å, —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|-----------|--------|-------|----------|
| Keycloak | SSO/OIDC | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä |
| Nextcloud | –§–∞–π–ª—ã, —à–∞—Ä–∏–Ω–≥ | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ | –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ç—è–∂–µ–ª–∞ (2+ –ì–ë) |
| Gitea | Git —Ö–æ—Å—Ç–∏–Ω–≥ | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚úÖ –õ–µ–≥–∫–∞—è, –ø—Ä–æ—Å—Ç–∞—è |
| Mattermost | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —á–∞—Ç | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Rocketchat, Zulip |
| Redmine | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ | ‚ö†Ô∏è –û—Ç–¥–µ–ª—å–Ω–æ | ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: OpenProject, Taiga |
| Wiki.js | –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Docusaurus, MkDocs |

---

### MONITORING SERVICES (–ß–∞—Å—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|-----------|--------|-------|---------|
| Prometheus | TSDB –º–µ—Ç—Ä–∏–∫ | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚ö†Ô∏è –ù—É–∂–µ–Ω Alertmanager |
| Grafana | –î–∞—à–±–æ—Ä–¥—ã | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚úÖ –û–ö (OIDC —Å Keycloak) |
| cAdvisor | –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –°–ü–û–†–ù–û | ‚ö†Ô∏è –î—É–±–ª–∏—Ä—É–µ—Ç Prometheus |
| postgres_exporter | –ú–µ—Ç—Ä–∏–∫–∏ PostgreSQL | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚úÖ –û–ö |
| redis_exporter | –ú–µ—Ç—Ä–∏–∫–∏ Redis | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚úÖ –û–ö |
| Alertmanager | –û–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ | ‚ùå –ù–ï–¢ | ‚úÖ –î–ê | üî¥ –ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨ |
| Loki | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ –ï—Å—Ç—å? | ‚úÖ –î–ê | ‚ö†Ô∏è –ù–µ–ø–æ–ª–Ω–∞—è (–Ω–µ—Ç Promtail) |

---

### OBSERVABILITY SERVICES (–ö–æ–Ω—Ñ–ª–∏–∫—Ç!)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|-----------|--------|-------|---------|
| Jaeger | Distributed tracing | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –°–ü–û–†–ù–û | üî¥ –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤ —Å Tempo |
| OTEL Collector | –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–π—Å–æ–≤ | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –°–ü–û–†–ù–û | üî¥ –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤ (4317/4318) |
| Tempo | –¢—Ä–µ–π—Å–∏–Ω–≥ (Grafana) | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | üî¥ –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤ |
| Promtail | –°–±–æ—Ä –ª–æ–≥–æ–≤ | ‚ùå –ù–ï–¢ | ‚úÖ –î–ê | üî¥ –ö–†–ò–¢–ò–ß–ù–û –ù–£–ñ–ï–ù |

---

### OPS SERVICES (–û–ö)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ó–∞–º–µ–Ω–∞? |
|--------|-----------|--------|-------|---------|
| Portainer | GUI –¥–ª—è Docker | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –ú–û–ñ–ï–¢ –ë–´–¢–¨ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Lazydocker CLI |
| Uptime Kuma | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê | ‚úÖ –•–æ—Ä–æ—à–∏–π –≤—ã–±–æ—Ä |

---

### EDGE SERVICE (–û–ö)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? |
|--------|-----------|--------|-------|
| Caddy | Reverse proxy, HTTPS | ‚úÖ –ï—Å—Ç—å | ‚úÖ –î–ê |

---

### VPN SERVICE (–û–ö, –Ω–æ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
|--------|-----------|--------|-------|--------------|
| WireGuard (wg-easy) | VPN –¥–æ—Å—Ç—É–ø | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û | Tailscale (–Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç) |

---

### MAIL SERVICE (–ü—Ä–æ–±–ª–µ–º–∞: –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω—É–∂–Ω–∞)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|-----------|--------|-------|---------|
| Mailu (SMTP/IMAP) | –ü–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –°–ü–û–†–ù–û | ‚ùå –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –¥–æ—Ä–æ–≥–∞—è |

---

### HA SERVICES (–î–æ–±–∞–≤–∏—Ç—å, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ö–æ–≥–¥–∞ |
|--------|-----------|--------|-------|-------|
| Patroni + etcd | PostgreSQL HA | ‚ö†Ô∏è –ö–æ–Ω—Ñ–∏–≥ –µ—Å—Ç—å | ‚ùå –î–ê (Large) | –¢–æ–ª—å–∫–æ –¥–ª—è Large –ø—Ä–æ—Ñ–∏–ª—è |
| Redis Sentinel | Redis HA | ‚ö†Ô∏è –ö–æ–Ω—Ñ–∏–≥ –µ—Å—Ç—å | ‚ùå –î–ê (Large) | –¢–æ–ª—å–∫–æ –¥–ª—è Large –ø—Ä–æ—Ñ–∏–ª—è |
| HAProxy | –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ | ‚ö†Ô∏è –ö–æ–Ω—Ñ–∏–≥ –µ—Å—Ç—å | ‚ùå –î–ê (Large) | –¢–æ–ª—å–∫–æ –¥–ª—è Large –ø—Ä–æ—Ñ–∏–ª—è |

---

### VAULT SERVICE (–ü—Ä–æ–±–ª–µ–º–∞: –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω—É–∂–Ω–∞)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
|--------|-----------|--------|-------|--------------|
| Hashicorp Vault | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏ | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –°–ü–û–†–ù–û | k8s Sealed Secrets, –∏–ª–∏ .env —Ñ–∞–π–ª—ã |

---

### EDMS SERVICE (–í–æ–ø—Ä–æ—Å: –∫–æ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ?)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|-----------|--------|-------|---------|
| Mayan EDMS | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ | ‚úÖ –ï—Å—Ç—å | ‚ùå –ù–ï–¢ | –û—á–µ–Ω—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ, —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |

---

### OPA + TUNNEL + API GATEWAY (–°–ø–µ—Ü—Å–ª—É—á–∞–∏)

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ù—É–∂–µ–Ω? | –î–ª—è –∫–æ–≥–æ |
|--------|-----------|--------|-------|----------|
| OPA | –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø (K8s) | ‚úÖ –ï—Å—Ç—å | ‚ùå –†–ï–î–ö–û | –¢–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ RBAC |
| Cloudflare Tunnel | –ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–∞—Ä—É–∂—É | ‚úÖ –ï—Å—Ç—å | ‚ö†Ô∏è –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û | –ï—Å–ª–∏ –ø—É–±–ª–∏–∫—É–µ—Ç–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç |
| Kong / API Gateway | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API | ‚ö†Ô∏è –ù–µ—Ç | ‚ùå –†–ï–î–ö–û | –¢–æ–ª—å–∫–æ –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ |

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### ‚úÖ –û–°–¢–ê–í–ò–¢–¨ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
```
Core:         PostgreSQL, Redis
Apps:         Keycloak, Gitea (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã)
Monitoring:   Prometheus, Grafana, exporters
Ops:          Uptime Kuma
Edge:         Caddy
```
**–ò—Ç–æ–≥–æ:** ~10 —Å–µ—Ä–≤–∏—Å–æ–≤ (—è–¥—Ä–æ)

---

### ‚ö†Ô∏è –û–°–¢–ê–í–ò–¢–¨ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
Apps:         Nextcloud (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ç—è–∂–µ–ª—ã–π)
Monitoring:   Alertmanager (–Ω—É–∂–µ–Ω –¥–ª—è –∞–ª–µ—Ä—Ç–æ–≤)
Observability: Tempo + Promtail (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + —Ç—Ä–µ–π—Å–∏–Ω–≥)
Ops:          Portainer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å CLI)
VPN:          WireGuard (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω —É–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø)
```
**–ò—Ç–æ–≥–æ:** +5 —Å–µ—Ä–≤–∏—Å–æ–≤ = ~15 —Å–µ—Ä–≤–∏—Å–æ–≤ (medium –ø—Ä–æ—Ñ–∏–ª—å)

---

### ‚ùå –£–î–ê–õ–ò–¢–¨ / –ó–ê–ú–ï–ù–ò–¢–¨

#### 1. Jaeger ‚Üí **–£–î–ê–õ–ò–¢–¨**
- **–ü–æ—á–µ–º—É:** Tempo –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –ª—É—á—à–µ (Grafana native)
- **–≠–∫–æ–Ω–æ–º–∏—è:** -1 –ì–ë RAM
- **–î–µ–π—Å—Ç–≤–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–∑ observability.yml

#### 2. OTEL Collector ‚Üí **–£–î–ê–õ–ò–¢–¨**
- **–ü–æ—á–µ–º—É:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ
- **–≠–∫–æ–Ω–æ–º–∏—è:** -512 MB RAM
- **–î–µ–π—Å—Ç–≤–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–∑ observability.yml

#### 3. cAdvisor ‚Üí **–ü–ï–†–ï–°–ú–û–¢–†–ï–¢–¨**
- **–û–ø—Ü–∏—è 1:** –£–¥–∞–ª–∏—Ç—å (–µ—Å–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Ç—Ä–∏–∫ –æ—Ç exporters)
- **–û–ø—Ü–∏—è 2:** –û—Å—Ç–∞–≤–∏—Ç—å (–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å Prometheus)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–î–ê–õ–ò–¢–¨ (–∏–∑–±—ã—Ç–æ—á–µ–Ω)

#### 4. Mattermost ‚Üí **–ü–ï–†–ï–°–ú–û–¢–†–ï–¢–¨**
- **–°—Ç–∞—Ç—É—Å:** –¢—è–∂–µ–ª—ã–π (~1.5 –ì–ë RAM)
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:** 
  - Zulip (–ª–µ–≥—á–µ)
  - Rocketchat (–∞–Ω–∞–ª–æ–≥)
  - Slack/Teams (–≤–Ω–µ—à–Ω–∏–π)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å

#### 5. Redmine ‚Üí **–ü–ï–†–ï–°–ú–û–¢–†–ï–¢–¨**
- **–°—Ç–∞—Ç—É—Å:** –û—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å, –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω—É–∂–µ–Ω
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
  - OpenProject (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–µ–µ)
  - Taiga (–¥–ª—è Agile)
  - Jira/Linear (–≤–Ω–µ—à–Ω–∏–µ)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å

#### 6. Mailu (–ø–æ—á—Ç–∞) ‚Üí **–û–°–¢–ê–í–ò–¢–¨, –ù–û –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–µ–±—É–µ—Ç DNS/SPF/DKIM –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞:** –û—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –º–æ–¥—É–ª–µ
- **–ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π SMTP (SendGrid, etc)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å

#### 7. Mayan EDMS ‚Üí **–£–î–ê–õ–ò–¢–¨ –ò–ó –û–°–ù–û–í–ù–û–ì–û**
- **–ü–æ—á–µ–º—É:** –û—á–µ–Ω—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ, —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (advanced/)

#### 8. Vault ‚Üí **–ü–ï–†–ï–°–ú–û–¢–†–ï–¢–¨**
- **–î–ª—è Docker:** –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω—É–∂–µ–Ω (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ .env + —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
- **–î–ª—è K8s:** –ù—É–∂–µ–Ω Sealed Secrets
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π (–¥–ª—è Large –ø—Ä–æ—Ñ–∏–ª—è)

---

## üìà –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### Small (–ª–æ–∫–∞–ª–∫–∞, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
```
core.yml:       postgresql, redis
apps.yml:       keycloak, gitea, nextcloud
monitoring.yml: prometheus, grafana, postgres_exporter, redis_exporter, alertmanager
ops.yml:        uptime-kuma
edge.yml:       caddy

–°–µ—Ä–≤–∏—Å–æ–≤: ~12
RAM:      4 GB
```

### Medium (production, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
Small + 
observability.yml: loki, promtail, tempo (–≤–º–µ—Å—Ç–æ Jaeger)
vpn.yml:           wireguard, wg-easy
ops.yml:           + portainer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–°–µ—Ä–≤–∏—Å–æ–≤: ~15
RAM:      8 GB
```

### Large (enterprise, HA)
```
Medium +
ha.yml:            patroni (postgres), redis-sentinel, haproxy, keepalived, etcd
vault.yml:         vault (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ–∫—Ä–µ—Ç–∞–º–∏)
opa.yml:           open-policy-agent (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏)
mail.yml:          mailu (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å–≤–æ—è –ø–æ—á—Ç–∞)

–°–µ—Ä–≤–∏—Å–æ–≤: ~25-30
RAM:      16+ GB
```

### Advanced / Optional (—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
```
mattermost.yml:  –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω —á–∞—Ç)
redmine.yml:     –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏)
mayan.yml:       –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏)
tunnel.yml:      cloudflare tunnel (–µ—Å–ª–∏ –ø—É–±–ª–∏–∫—É–µ—Ç–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç)
```

---

## üîß –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

### –≠—Ç–∞–ø 1: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–ö–†–ò–¢–ò–ß–ù–û)

1. **–£–¥–∞–ª–∏—Ç—å –∏–∑ observability.yml:**
   - ‚ùå Jaeger (–∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å Tempo)
   - ‚ùå OTEL Collector (–∫–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤)
   - ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ: Tempo, Promtail, Loki

2. **–î–æ–±–∞–≤–∏—Ç—å –≤ monitoring.yml:**
   - ‚úÖ Alertmanager (—Å alert-rules.yml)
   - ‚úÖ Prometheus –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –∞–ª–µ—Ä—Ç–æ–≤

3. **–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å Loki:**
   - ‚ùå –ò–∑ monitoring.yml
   - ‚úÖ –í observability.yml (–≥–¥–µ –æ–Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å)

### –≠—Ç–∞–ø 2: –û—á–∏—Å—Ç–∫–∞ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

4. **–£–¥–∞–ª–∏—Ç—å/–ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å cAdvisor:**
   - ‚ùå –ï—Å–ª–∏ –¥—É–±–ª–∏—Ä—É–µ—Ç Prometheus
   - ‚úÖ –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã

5. **–†–∞–∑–¥–µ–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
   - ‚úÖ –úattermost ‚Üí –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
   - ‚úÖ Redmine ‚Üí –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
   - ‚úÖ Mayan EDMS ‚Üí –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å

### –≠—Ç–∞–ø 3: –î–æ–±–∞–≤–∏—Ç—å

6. **Promtail:**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤ observability.yml
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä –ª–æ–≥–æ–≤ —Å–æ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

7. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å docs/
   - ‚úÖ –£–∫–∞–∑–∞—Ç—å –∫–∞–∫–∏–µ –º–æ–¥—É–ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
   - ‚úÖ –£–∫–∞–∑–∞—Ç—å –∫–∞–∫–∏–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–µ–∫—É—â–µ–µ | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ |
|---------|---------|-----------------|
| **–°–µ—Ä–≤–∏—Å–æ–≤ –≤ Small** | ~20 | **~12** |
| **–°–µ—Ä–≤–∏—Å–æ–≤ –≤ Medium** | ~30 | **~15** |
| **–°–µ—Ä–≤–∏—Å–æ–≤ –≤ Large** | 45+ | **~25-30** |
| **–ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–æ—Ä—Ç–æ–≤** | 5+ | **0** |
| **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** | 3+ | **0** |
| **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö** | 2 | **0** |
| **RAM (Large)** | 56+ GB | **~24 GB** |

---

## üéØ –î–ï–ô–°–¢–í–ò–ï

**–ì–æ—Ç–æ–≤ –ª–∏ —è:**
1. ‚úÖ –£–¥–∞–ª–∏—Ç—å Jaeger + OTEL Collector?
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Alertmanager?
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å Promtail?
4. ‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å Loki?
5. ‚úÖ –°–æ–∑–¥–∞—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ (mattermost, redmine, mayan)?
6. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é?

–î–∞–π –º–Ω–µ –∑–µ–ª—ë–Ω—ã–π —Å–≤–µ—Ç –∏ —è –≤—Å—ë –∏—Å–ø—Ä–∞–≤–ª—é! üöÄ
