# üöÄ CERES 3-VM ENTERPRISE DEPLOYMENT

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ 3 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö Proxmox

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

### VM1: CORE (192.168.1.10) - 4 CPU, 8GB RAM, 50GB
**–ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
1. PostgreSQL - –≥–ª–∞–≤–Ω–∞—è –°–£–ë–î
2. Redis - –∫—ç—à –∏ –æ—á–µ—Ä–µ–¥–∏
3. Keycloak - SSO/OIDC

### VM2: APPS (192.168.1.11) - 4 CPU, 8GB RAM, 80GB
**–ë–∏–∑–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
4. Nextcloud - —Ñ–∞–π–ª—ã
5. Gitea - Git —Ö–æ—Å—Ç–∏–Ω–≥
6. Mattermost - —á–∞—Ç
7. **Redmine** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
8. Wiki.js - –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
9. Mayan EDMS - –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç
10-14. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (init, rabbitmq, redis –¥–ª—è Mayan)

### VM3: MONITORING (192.168.1.12) - 2 CPU, 4GB RAM, 40GB
**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å–µ—Ç—å:**
15. Prometheus - –º–µ—Ç—Ä–∏–∫–∏
16. Grafana - –¥–∞—à–±–æ—Ä–¥—ã
17. Loki - –ª–æ–≥–∏
18. Promtail - —Å–±–æ—Ä—â–∏–∫ –ª–æ–≥–æ–≤
19. cAdvisor - –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
20. postgres_exporter
21. redis_exporter
22. Portainer - UI Docker
23. Uptime Kuma - uptime –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
24. Caddy - reverse proxy + SSL
25. WireGuard - VPN

---

## üöÄ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ó–ê–ü–£–°–ö

### –ù–∞ Proxmox —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Proxmox
ssh root@192.168.1.3

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å –∞—Ä—Ö–∏–≤)
# scp Ceres-deploy.zip root@192.168.1.3:/tmp/

# 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
bash << 'EOF'
# [–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ deploy-3vm-enterprise.sh —Å—é–¥–∞]
EOF
```

**–ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:**

```bash
wget -O /tmp/deploy-3vm.sh https://your-repo/deploy-3vm-enterprise.sh
chmod +x /tmp/deploy-3vm.sh
/tmp/deploy-3vm.sh
```

---

## ‚è±Ô∏è –í—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è: ~20 –º–∏–Ω—É—Ç

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. ‚úÖ –°–∫–∞—á–∏–≤–∞–µ—Ç Ubuntu Cloud Image
2. ‚úÖ –°–æ–∑–¥–∞—ë—Ç 3 VM —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
3. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker –Ω–∞ –≤—Å–µ VM
4. ‚úÖ –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞ –∫–∞–∂–¥–æ–π VM
5. ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã —Å–æ–≥–ª–∞—Å–Ω–æ –ª–æ–≥–∏–∫–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
6. ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –º–µ–∂—Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

---

## üîß –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

### Phase 1: Download Cloud Image
- –°–∫–∞—á–∏–≤–∞–µ—Ç Ubuntu 22.04 Cloud Image (–µ—Å–ª–∏ –Ω–µ—Ç)

### Phase 2: Create VMs
- VM1 (ceres-core): 4 CPU, 8GB RAM, 50GB
- VM2 (ceres-apps): 4 CPU, 8GB RAM, 80GB
- VM3 (ceres-monitoring): 2 CPU, 4GB RAM, 40GB

### Phase 3: Install Docker
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker + Docker Compose –Ω–∞ –∫–∞–∂–¥–æ–π VM

### Phase 4: Deploy Files
- –ö–æ–ø–∏—Ä—É–µ—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞ –≤—Å–µ VM
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### Phase 5: Start Services
- **VM1:** `core.yml` (PostgreSQL, Redis, Keycloak)
- **VM2:** `apps.yml + redmine.yml + edms.yml` (–≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- **VM3:** `monitoring.yml + ops.yml + edge.yml + vpn.yml`

### Phase 6: Verification
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

---

## üåê –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

### –î–æ–±–∞–≤—å—Ç–µ –≤ hosts (`C:\Windows\System32\drivers\etc\hosts`):

```
192.168.1.12  auth.ceres.local
192.168.1.12  nextcloud.ceres.local
192.168.1.12  gitea.ceres.local
192.168.1.12  mattermost.ceres.local
192.168.1.12  redmine.ceres.local
192.168.1.12  wiki.ceres.local
192.168.1.12  edms.ceres.local
192.168.1.12  grafana.ceres.local
192.168.1.12  portainer.ceres.local
```

### –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

- **Keycloak (SSO):** https://auth.ceres.local
- **Nextcloud:** https://nextcloud.ceres.local
- **Gitea:** https://gitea.ceres.local
- **Mattermost:** https://mattermost.ceres.local
- **Redmine:** https://redmine.ceres.local (admin / admin - –ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥)
- **Wiki.js:** https://wiki.ceres.local
- **Mayan EDMS:** https://edms.ceres.local
- **Grafana:** https://grafana.ceres.local
- **Portainer:** https://portainer.ceres.local

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### –ù–∞ –∫–∞–∂–¥–æ–π VM:

```bash
# VM1 (Core)
ssh root@192.168.1.10
docker ps

# VM2 (Apps)
ssh root@192.168.1.11
docker ps

# VM3 (Monitoring)
ssh root@192.168.1.12
docker ps
```

### –ò–ª–∏ —á–µ—Ä–µ–∑ Proxmox:

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö VM
qm list

# –ö–æ–Ω—Å–æ–ª—å VM
qm terminal 110  # VM1
qm terminal 111  # VM2
qm terminal 112  # VM3
```

---

## üìù –õ–æ–≥–∏–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

### –ü–æ—á–µ–º—É —Ç–∞–∫?

**VM1 (Core)** - –∫—Ä–∏—Ç–∏—á–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- PostgreSQL –∏ Redis –Ω—É–∂–Ω—ã –≤—Å–µ–º
- Keycloak - –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞

**VM2 (Apps)** - –±–∏–∑–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤ (80GB –¥–∏—Å–∫–∞)
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ú–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

**VM3 (Monitoring)** - –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∏ —Å–µ—Ç—å:
- Caddy –∫–∞–∫ –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (reverse proxy)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- VPN –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

---

## üîÑ –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–≤—è–∑—å

### PostgreSQL –∏ Redis (VM1) –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤—Å–µ—Ö:

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è–µ—Ç:
- `postgres:5432` ‚Üí `192.168.1.10:5432`
- `redis:6379` ‚Üí `192.168.1.10:6379`

### Caddy (VM3) –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã:

```
auth.ceres.local ‚Üí 192.168.1.10:8080 (Keycloak –Ω–∞ VM1)
nextcloud.ceres.local ‚Üí 192.168.1.11:80 (Nextcloud –Ω–∞ VM2)
redmine.ceres.local ‚Üí 192.168.1.11:3000 (Redmine –Ω–∞ VM2)
grafana.ceres.local ‚Üí 192.168.1.12:3000 (Grafana –Ω–∞ VM3)
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Firewall –Ω–∞ –∫–∞–∂–¥–æ–π VM:

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã
ufw allow from 192.168.1.0/24  # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å
ufw allow 51820/udp            # WireGuard (—Ç–æ–ª—å–∫–æ VM3)
ufw enable
```

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:

Caddy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤.

---

## üî• Redmine –≤–º–µ—Å—Ç–æ Taiga

### –ü–æ—á–µ–º—É Redmine?

‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–µ–µ** - –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≥–æ–¥–∞–º–∏  
‚úÖ **–ü–ª–∞–≥–∏–Ω—ã** - –æ–≥—Ä–æ–º–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞  
‚úÖ **Git –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å Gitea  
‚úÖ **Wiki** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π  
‚úÖ **Gantt** - –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è  
‚úÖ **–õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π** - –º–µ–Ω—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤  

### –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥:

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://redmine.ceres.local
2. –õ–æ–≥–∏–Ω: `admin`
3. –ü–∞—Ä–æ–ª—å: `admin`
4. –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
5. Administration ‚Üí Settings ‚Üí –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã

---

## üìä –†–µ—Å—É—Ä—Å—ã

### –í—Å–µ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è:

- **CPU:** 10 cores (4+4+2)
- **RAM:** 20GB (8+8+4)
- **Disk:** 170GB (50+80+40)

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π Proxmox —Å–µ—Ä–≤–µ—Ä:

- CPU: 12+ cores
- RAM: 32GB
- Disk: 200GB+ SSD

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —É –≤–∞—Å –±—É–¥–µ—Ç:

‚úÖ 3 VM —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π  
‚úÖ 25+ —Å–µ—Ä–≤–∏—Å–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ª–æ–≥–∏—á–Ω–æ  
‚úÖ Redmine –≤–º–µ—Å—Ç–æ Taiga  
‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥  
‚úÖ SSO —á–µ—Ä–µ–∑ Keycloak  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π HTTPS  
‚úÖ VPN –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞  

**–ù–ê–°–¢–û–Ø–©–ò–ô ENTERPRISE –Ω–∞ 3 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö!** üöÄ
