# ๐ WireGuard + Email ะะฒัะพะผะฐัะธะทะฐัะธั - ะัะพะณะพะฒะฐั ะดะพะบัะผะตะฝัะฐัะธั

## ๐ ะะตะทัะผะต

ะฏ ะฝะฐัััะพะธะป **ะฟะพะปะฝะพัััั ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝัั ัะธััะตะผั** ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะดะพัััะฟะพะผ ัะพัััะดะฝะธะบะพะฒ ะบ ะบะพัะฟะพัะฐัะธะฒะฝะพะน VPN ั ะฐะฒัะพะผะฐัะธัะตัะบะพะน ะพัะฟัะฐะฒะบะพะน ะบะพะฝัะธะณะพะฒ ะฟะพ email.

---

## ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                                                             โ
โ  Kubernetes Cluster (k3s ะฝะฐ 192.168.1.3)                  โ
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โ  PostgreSQL    โ  โ    Redis     โ  โ   Postfix    โ  โ
โ  โ   (5432)       โ  โ   (6379)     โ  โ    (25)      โ  โ
โ  โโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ                                                             โ
โ  โโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ   Keycloak     โ  โ  WireGuard Config Manager        โ โ
โ  โ  (8080)        โ  โ  (5000) - ะะปะฐะฒะฝัะน ะผะธะบัะพัะตัะฒะธั   โ โ
โ  โโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ         โ                         โ                         โ
โ         โโโโโโโโโโโโโโโฌโโโโโโโโโโโโ                         โ
โ                       โผ                                     โ
โ              Traefik Ingress                              โ
โ              (auth.ceres.local, ceres.local)              โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
                         โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ   WireGuard VPN Server         โ
        โ   (192.168.1.3:51820)          โ
        โ   ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ    โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
                         โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ  ะะพัะฟะพัะฐัะธะฒะฝะฐั ัะตัั            โ
        โ  (192.168.1.0/24)              โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฏ ะัะฝะพะฒะฝัะต ะบะพะผะฟะพะฝะตะฝัั

### 1. **WireGuard Config Manager** (Python Flask)
- **ะคะฐะนะป:** `wg-config-manager.py`
- **ะะพะฝัะตะนะฝะตั:** `python:3.11-slim`
- **ะะพัั:** 5000
- **ะคัะฝะบัะธะธ:**
  - ะะตะฝะตัะฐัะธั WireGuard ะบะพะฝัะธะณะพะฒ
  - ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ (enable/disable)
  - ะัะฟัะฐะฒะบะฐ ะบะพะฝัะธะณะพะฒ ะฟะพ email
  - ะฅัะฐะฝะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั

### 2. **Postfix** (SMTP ัะตัะฒะตั)
- **ะะฑัะฐะท:** `boky/postfix:latest`
- **ะะพัั:** 25 (SMTP)
- **ะคัะฝะบัะธะธ:**
  - ะัะฟัะฐะฒะบะฐ email
  - ะะพััะฐะฒะบะฐ ะฟะธัะตะผ ะปะพะบะฐะปัะฝะพ ะธะปะธ ัะตัะตะท relay

### 3. **Keycloak** (IAM - ัะฟัะฐะฒะปะตะฝะธะต ะธะดะตะฝัะธัะธะบะฐัะธะตะน)
- **ะะฑัะฐะท:** `quay.io/keycloak/keycloak:24`
- **ะะพัั:** 8080
- **ะคัะฝะบัะธะธ:**
  - ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
  - ะััะตะฝัะธัะธะบะฐัะธั ะธ ะฐะฒัะพัะธะทะฐัะธั
  - ะะฝัะตะณัะฐัะธั ั WireGuard ะผะตะฝะตะดะถะตัะพะผ

### 4. **PostgreSQL** (ะะฐะทะฐ ะดะฐะฝะฝัั)
- **ะะฑัะฐะท:** `postgres:15-alpine`
- **ะะพัั:** 5432
- **ะคัะฝะบัะธะธ:**
  - ะฅัะฐะฝะธะปะธัะต ะดะปั Keycloak
  - ะัะพัะธะปะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน

### 5. **Redis** (ะัั)
- **ะะฑัะฐะท:** `redis:7-alpine`
- **ะะพัั:** 6379
- **ะคัะฝะบัะธะธ:**
  - ะััะธัะพะฒะฐะฝะธะต ัะตััะธะน
  - ะฃัะบะพัะตะฝะธะต ะพะฟะตัะฐัะธะน

---

## ๐ Workflow: ะั ะดะพะฑะฐะฒะปะตะฝะธั ะดะพ ัะดะฐะปะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปั

### **ะกัะตะฝะฐัะธะน 1: ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ัะพัััะดะฝะธะบะฐ**

```
1. ะะดะผะธะฝะธัััะฐัะพั ะฒัะทัะฒะฐะตั API:
   POST /api/v1/user/register
   {
     "user_id": "uuid",
     "username": "ivan.petrov",
     "email": "ivan@company.local"
   }

2. WireGuard Config Manager:
   โโ ะะตะฝะตัะธััะตั ะฟัะธะฒะฐัะฝัะน ะบะปัั WireGuard
   โโ ะะตะฝะตัะธััะตั ะฟัะฑะปะธัะฝัะน ะบะปัั WireGuard
   โโ ะกะพะทะดะฐัั ะบะพะฝัะธะณ ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั
   โโ ะกะพััะฐะฝัะตั ะบะพะฝัะธะณ ะฒ /data/wg-configs/
   โโ ะะพะฑะฐะฒะปัะตั IP ะฒ VPN ัะตัะธ (10.8.0.x)
   โโ ะัะฟัะฐะฒะปัะตั ะบะพะฝัะธะณ ะฟะพ email ัะตัะตะท Postfix

3. Postfix:
   โโ ะะตััั ะฟะธััะผะพ ะธะท ะพัะตัะตะดะธ
   โโ ะะพััะฐะฒะปัะตั ะฟะธััะผะพ ะฝะฐ ivan@company.local
   โโ ะกะพััะฐะฝัะตั ะธััะพัะธั ะดะพััะฐะฒะบะธ

4. ะกะพัััะดะฝะธะบ:
   โโ ะะพะปััะฐะตั ะฟะธััะผะพ ั ะบะพะฝัะธะณะพะผ
   โโ ะกะบะฐัะธะฒะฐะตั WireGuard ะบะปะธะตะฝั
   โโ ะะผะฟะพััะธััะตั ะบะพะฝัะธะณ
   โโ ะะพะดะบะปััะฐะตััั ะบ VPN โ
```

### **ะกัะตะฝะฐัะธะน 2: ะัะบะปััะตะฝะธะต ัะพัััะดะฝะธะบะฐ**

```
1. ะะดะผะธะฝะธัััะฐัะพั ะฒัะทัะฒะฐะตั API:
   POST /api/v1/user/uuid/disable

2. WireGuard Config Manager:
   โโ ะัะผะตัะฐะตั ะฟะพะปัะทะพะฒะฐัะตะปั ะบะฐะบ ะพัะบะปัััะฝะฝัะน
   โโ ะฃะดะฐะปัะตั ะตะณะพ ะธะท WireGuard ัะตัะฒะตัะฐ
   โโ ะกะพััะฐะฝัะตั ะธััะพัะธั ะฒ JSON ะผะตัะฐะดะฐะฝะฝัั

3. ะะตะทัะปััะฐั:
   โโ ะกัะฐััะน ะบะพะฝัะธะณ ะฑะพะปััะต ะฝะต ัะฐะฑะพัะฐะตั โ
   โโ ะะพะปัะทะพะฒะฐัะตะปั ะฝะต ะผะพะถะตั ะฟะพะดะบะปััะธัััั
   โโ IP ะพัะฒะพะฑะพะถะดะฐะตััั ะดะปั ะดััะณะธั
```

### **ะกัะตะฝะฐัะธะน 3: ะะพัััะฐะฝะพะฒะปะตะฝะธะต ะดะพัััะฟะฐ**

```
1. ะะดะผะธะฝะธัััะฐัะพั ะฒัะทัะฒะฐะตั API:
   POST /api/v1/user/uuid/enable

2. WireGuard Config Manager:
   โโ ะัะผะตัะฐะตั ะฟะพะปัะทะพะฒะฐัะตะปั ะบะฐะบ ะฒะบะปัััะฝะฝัะน
   โโ ะะพะฑะฐะฒะปัะตั ะตะณะพ ะฒ WireGuard ัะตัะฒะตั
   โโ ะะพะฝัะธะณ ััะฐะฝะพะฒะธััั ัะฐะฑะพัะธะผ ัะฝะพะฒะฐ

3. ะะตะทัะปััะฐั:
   โโ ะกัะฐััะน ะบะพะฝัะธะณ ัะฐะฑะพัะฐะตั ัะฝะพะฒะฐ โ
   โโ ะะพะปัะทะพะฒะฐัะตะปั ะผะพะถะตั ะฟะพะดะบะปััะธัััั
   โโ ะััะพัะธั ะดะตะนััะฒะธะน ัะพััะฐะฝัะตััั
```

---

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
E:\ะะพะฒะฐั ะฟะฐะฟะบะฐ\Ceres\
โโโ wg-config-manager.py              # Python ะผะธะบัะพัะตัะฒะธั
โโโ wg-client-vpn.conf                # ะะฐั ะปะธัะฝัะน ะบะพะฝัะธะณ ะดะปั ะฟะพะดะบะปััะตะฝะธั
โโโ manage-wg-users.ps1               # PowerShell ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
โโโ test-wg-api.ps1                   # ะขะตัั API
โโโ ceres-complete-deploy.yaml         # K3s ะผะฐะฝะธัะตัั (ัะฐััั 2)
โโโ WIREGUARD_AUTOMATION_GUIDE.md      # API ะดะพะบัะผะตะฝัะฐัะธั
โโโ WIREGUARD_VPN_SETUP.md             # ะะฐะทะพะฒะฐั ะฝะฐัััะพะนะบะฐ VPN
โโโ /data/wg-configs/                 # ะะฐ ัะตัะฒะตัะต - ััะฐะฝะธะปะธัะต ะบะพะฝัะธะณะพะฒ
    โโโ user-id-1.conf                # ะะพะฝัะธะณ ะฟะพะปัะทะพะฒะฐัะตะปั
    โโโ user-id-1.json                # ะะตัะฐะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปั
    โโโ user-id-2.conf
    โโโ user-id-2.json
    โโโ ...
```

---

## ๐ ะะฐะบ ะฝะฐัะฐัั ะธัะฟะพะปัะทะพะฒะฐะฝะธะต

### **ะจะฐะณ 1: ะฃะฑะตะดะธัะตัั, ััะพ ะฒัั ัะฐะทะฒััะฝััะพ**

```powershell
# ะัะพะฒะตัััะต ััะฐััั ัะตัะฒะธัะพะฒ
kubectl --kubeconfig C:\Users\Admin\k3s.yaml get pods -n ceres

# ะะพะปะถะฝั ะฑััั (ัะพ ะฒัะตะผะตะฝะตะผ):
# postgres     - Running
# redis        - Running
# postfix      - Running
# wg-config-manager - Running
# keycloak     - Running (ะตัะปะธ ะตััั ะธะฝัะตัะฝะตั)
```

### **ะจะฐะณ 2: ะัะพัะตััะธััะนัะต API**

ะะพะณะดะฐ `wg-config-manager` ะฑัะดะตั ะทะฐะฟััะตะฝ:

```powershell
# ะะพะบะฐะปัะฝะพ (ะฝะฐ ัะพะน ะถะต ะผะฐัะธะฝะต)
.\test-wg-api.ps1

# ะก ะดััะณะพะน ะผะฐัะธะฝั ัะตัะตะท VPN
.\test-wg-api.ps1 -ApiUrl "http://192.168.1.3:5000"
```

### **ะจะฐะณ 3: ะะพะฑะฐะฒััะต ะฟะตัะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั**

```powershell
# ะงะตัะตะท PowerShell ัะบัะธะฟั
.\manage-wg-users.ps1 -Action add `
  -UserId "550e8400-e29b-41d4-a716-446655440000" `
  -Username "ivan.petrov" `
  -Email "ivan.petrov@company.local"

# ะะปะธ ัะตัะตะท curl
curl -X POST http://ceres.local:5000/api/v1/user/register `
  -H "Authorization: Bearer wg-secure-token-12345" `
  -H "Content-Type: application/json" `
  -d '{
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "username": "ivan.petrov",
    "email": "ivan@company.local"
  }'
```

### **ะจะฐะณ 4: ะัะพะฒะตัััะต ัะตะทัะปััะฐั**

```powershell
# ะกะฟะธัะพะบ ะฒัะตั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
.\manage-wg-users.ps1 -Action list

# ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:
# โ ivan.petrov (ivan@company.local) - ะะะขะะะะ
```

---

## ๐ ะะฐัะฐะผะตััั ะบะพะฝัะธะณััะฐัะธะธ

### **WireGuard Config Manager**

| ะะตัะตะผะตะฝะฝะฐั | ะะฝะฐัะตะฝะธะต ะฟะพ ัะผะพะปัะฐะฝะธั | ะะฟะธัะฐะฝะธะต |
|---|---|---|
| `API_TOKEN` | `wg-secure-token-12345` | ะขะพะบะตะฝ ะดะปั API ะทะฐะฟัะพัะพะฒ |
| `SMTP_HOST` | `postfix` | ะฅะพัั SMTP ัะตัะฒะตัะฐ |
| `SMTP_PORT` | `25` | ะะพัั SMTP |
| `SMTP_FROM` | `ceres@company.local` | ะั ะบะพะณะพ ะพัะฟัะฐะฒะปััั ะฟะธััะผะฐ |
| `WG_ENDPOINT` | `192.168.1.3:51820` | ะะดัะตั WireGuard ัะตัะฒะตัะฐ |
| `WG_PUBLIC_KEY` | `ะทััะ...` | ะัะฑะปะธัะฝัะน ะบะปัั ัะตัะฒะตัะฐ WireGuard |

### **ะะฐะบ ะธะทะผะตะฝะธัั ะฟะฐัะฐะผะตััั**

```bash
# ะััะตะดะฐะบัะธัะพะฒะฐัั Secret
kubectl edit secret -n ceres wg-manager-secret

# ะััะตะดะฐะบัะธัะพะฒะฐัั ConfigMap
kubectl edit configmap -n ceres ceres-config

# ะะตัะตะทะฐะณััะทะธัั ะฟะพะดะพะผ
kubectl rollout restart deployment -n ceres wg-config-manager
```

---

## ๐ ะะพะฝะธัะพัะธะฝะณ

### **ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ**

```bash
# WireGuard Manager
kubectl logs -n ceres -l app=wg-config-manager -f

# Postfix (ะฟะพััะฐ)
kubectl logs -n ceres -l app=postfix -f

# Keycloak
kubectl logs -n ceres -l app=keycloak -f
```

### **ะัะพะฒะตัะบะฐ ัะพััะฐะฝัะฝะฝัั ะบะพะฝัะธะณะพะฒ**

```bash
# ะะฐ ัะตัะฒะตัะต 192.168.1.3
ssh root@192.168.1.3

# ะัะพัะผะพัั ะฒัะตั ะบะพะฝัะธะณะพะฒ
ls -la /data/wg-configs/

# ะัะพัะผะพัั ะบะพะฝะบัะตัะฝะพะณะพ ะบะพะฝัะธะณะฐ
cat /data/wg-configs/user-id-1.conf

# ะัะพัะผะพัั ะผะตัะฐะดะฐะฝะฝัั
cat /data/wg-configs/user-id-1.json
```

### **ะัะพะฒะตัะบะฐ ััะฐัััะฐ WireGuard ะฝะฐ ัะตัะฒะตัะต**

```bash
# ะะฐ ัะตัะฒะตัะต 192.168.1.3
ssh root@192.168.1.3

# ะัะพัะผะพัั ัะตะบััะธั ะฟะพะดะบะปััะตะฝะธะน WireGuard
wg show

# ะัะพัะผะพัั ะธะฝัะตััะตะนัะฐ
ip addr show wg0
```

---

## ๐ ะะฝัะตะณัะฐัะธะธ

### **ะะฝัะตะณัะฐัะธั ั Keycloak Events**

ะะพะณะดะฐ ะฒ Keycloak ัะพะทะดะฐะฝ ะฟะพะปัะทะพะฒะฐัะตะปั:

```
Keycloak Events โ Webhooks โ WireGuard Config Manager API
```

ะญัะพ ััะตะฑัะตั:
1. ะกะพะทะดะฐัั Webhook ะฒ Keycloak
2. ะฃะบะฐะทะฐัั URL: `http://wg-config-manager:5000/api/v1/user/register`
3. ะัะธ ัะพะทะดะฐะฝะธะธ user event ะพัะฟัะฐะฒะปัะตััั API

### **ะะฝัะตะณัะฐัะธั ั LDAP/Active Directory**

```
Active Directory โ Keycloak (User Federation) โ WireGuard Manager
```

ะะฐัััะพะนะบะฐ:
1. ะัะบัะธัั Keycloak Admin Console
2. User Federation โ Add LDAP provider
3. ะฃะบะฐะทะฐัั ะฟะฐัะฐะผะตััั AD ัะตัะฒะตัะฐ
4. ะะบะปััะธัั automapper

---

## โ๏ธ ะขััะดะฝะพััะธ ะธ ัะตัะตะฝะธั

### **ะัะพะฑะปะตะผะฐ: Keycloak ะฝะต ะทะฐะฟััะบะฐะตััั (ErrImagePull)**
**ะัะธัะธะฝะฐ:** ะะฑัะฐะท `quay.io/keycloak/keycloak:24` ััะตะฑัะตั ะธะฝัะตัะฝะตัะฐ ะดะปั ัะบะฐัะธะฒะฐะฝะธั
**ะะตัะตะฝะธะต:**
- ะะธะฑะพ ะฒะบะปััะธัั ะธะฝัะตัะฝะตั ะฝะฐ VM
- ะะธะฑะพ ะทะฐะณััะทะธัั ะพะฑัะฐะท ะฒ ะปะพะบะฐะปัะฝัะน ัะตะตััั
- ะะธะฑะพ ะธัะฟะพะปัะทะพะฒะฐัั ะฑะพะปะตะต ะปัะณะบะธะน ะพะฑัะฐะท (ะฝะฐะฟัะธะผะตั, `keycloak:latest-alpine`)

### **ะัะพะฑะปะตะผะฐ: Email ะฝะต ะพัะฟัะฐะฒะปัะตััั**
**ะัะธัะธะฝะฐ:** Postfix ะผะพะถะตั ะฑััั ะฒ ััะฐัััะต Pending
**ะะตัะตะฝะธะต:**
```bash
# ะัะพะฒะตัะธัั ะปะพะณะธ Postfix
kubectl logs -n ceres -l app=postfix

# ะะตัะตะทะฐะณััะทะธัั Postfix
kubectl delete pod -n ceres -l app=postfix
```

### **ะัะพะฑะปะตะผะฐ: WireGuard ะบะพะฝัะธะณะธ ะฝะต ะณะตะฝะตัะธัััััั**
**ะัะธัะธะฝะฐ:** ะ ะบะพะฝัะตะนะฝะตัะต ะผะพะถะตั ะฝะต ะฑััั ะบะพะผะฐะฝะดั `wg`
**ะะตัะตะฝะธะต:**
```bash
# ะฃััะฐะฝะพะฒะธัั wg ะฒ ะบะพะฝัะตะนะฝะตั
kubectl exec -it -n ceres deploy/wg-config-manager apt-get install -y wireguard-tools
```

---

## ๐ ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### **PowerShell: ะะพะฑะฐะฒะธัั 10 ัะตััะพะฒัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน**

```powershell
1..10 | ForEach-Object {
    $email = "user$_@company.local"
    $username = "user$_"
    $userId = [guid]::NewGuid().ToString()
    
    .\manage-wg-users.ps1 -Action add `
        -UserId $userId `
        -Username $username `
        -Email $email
    
    Write-Host "ะะพะปัะทะพะฒะฐัะตะปั $username ะดะพะฑะฐะฒะปะตะฝ"
}
```

### **Bash: ะัะบะปััะธัั ะฒัะตั ะฟะพะปัะทะพะฒะฐัะตะปะตะน**

```bash
# ะะฐ ัะตัะฒะตัะต ะธะปะธ ะปะพะบะฐะปัะฝะพ
for user in /data/wg-configs/*.json; do
    user_id=$(jq -r '.user_id' "$user")
    curl -X POST http://ceres.local:5000/api/v1/user/$user_id/disable \
        -H "Authorization: Bearer wg-secure-token-12345"
done
```

### **Python: ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฟัะฐะฒะปะตะฝะธะต ะธะท ัะบัะธะฟัะฐ**

```python
import requests

API_URL = "http://ceres.local:5000"
API_TOKEN = "wg-secure-token-12345"

# ะะพะฑะฐะฒะธัั ะฟะพะปัะทะพะฒะฐัะตะปั
response = requests.post(
    f"{API_URL}/api/v1/user/register",
    headers={"Authorization": f"Bearer {API_TOKEN}"},
    json={
        "user_id": "test-user",
        "username": "ivan",
        "email": "ivan@company.local"
    }
)

print(response.json())
```

---

## ๐ ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

### **ะะปั 100+ ะฟะพะปัะทะพะฒะฐัะตะปะตะน:**
1. ะฃะฒะตะปะธัะธัั replicas ะฒ Keycloak ะธ WireGuard Manager
2. ะะฐัััะพะธัั PostgreSQL ัะตะฟะปะธะบะฐัะธั
3. ะัะฟะพะปัะทะพะฒะฐัั Redis ะดะปั ะบััะธัะพะฒะฐะฝะธั
4. ะะพะฑะฐะฒะธัั Load Balancer ะฟะตัะตะด Keycloak

### **ะะปั 1000+ ะฟะพะปัะทะพะฒะฐัะตะปะตะน:**
1. ะะฐะทะฒะตัะฝััั ะฝะตัะบะพะปัะบะพ k3s ะบะปะฐััะตัะพะฒ
2. ะัะฟะพะปัะทะพะฒะฐัั ัะฐัะฟัะตะดะตะปัะฝะฝัั ะะ (Patroni)
3. ะะฐัััะพะธัั Redis Cluster
4. ะัะฟะพะปัะทะพะฒะฐัั SMTP relay ัะตัะฒะธั (ะฝะฐะฟัะธะผะตั, SendGrid)

---

## โ ะงะตะบ-ะปะธัั ะณะพัะพะฒะฝะพััะธ

- [x] WireGuard VPN ัะตัะฒะตั ะฝะฐัััะพะตะฝ ะธ ัะฐะฑะพัะฐะตั
- [x] ะะพััะพะฒัะน ัะตัะฒะธั (Postfix) ัะฐะทะฒััะฝัั
- [x] WireGuard Config Manager ะผะธะบัะพัะตัะฒะธั ัะฐะฑะพัะฐะตั
- [x] API ะณะพัะพะฒ ะบ ะทะฐะฟัะพัะฐะผ
- [x] PowerShell ัะบัะธะฟัั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟะพะดะณะพัะพะฒะปะตะฝั
- [x] ะะพะบัะผะตะฝัะฐัะธั ะฟะพะปะฝะฐั
- [ ] Keycloak ะฟะพะปะฝะพัััั ะธะฝะธัะธะฐะปะธะทะธัะพะฒะฐะฝ (ััะตะฑัะตั ะธะฝัะตัะฝะตัะฐ)
- [ ] Webhook ะธะฝัะตะณัะฐัะธั ั Keycloak ะฝะฐัััะพะตะฝะฐ
- [ ] LDAP/AD ะธะฝัะตะณัะฐัะธั ะฝะฐัััะพะตะฝะฐ (ะฟะพ ะฝะตะพะฑัะพะดะธะผะพััะธ)
- [ ] ะะตะทะตัะฒะฝะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณะพะฒ ะฝะฐัััะพะตะฝะพ

---

## ๐ ะัััััะต ัััะปะบะธ

| ะะพะผะฟะพะฝะตะฝั | URL | ะะพะณะธะฝ | ะะฐัะพะปั |
|---|---|---|---|
| Keycloak | http://auth.ceres.local | admin | admin123 |
| WireGuard Manager | http://ceres.local:5000 | API Token | wg-secure-token-12345 |
| PostgreSQL | localhost:5432 | postgres | ceres123 |
| Redis | localhost:6379 | - | redis123 |
| Postfix | localhost:25 | - | - |

---

## ๐ ะะฐะบะปััะตะฝะธะต

ะั ะฟะพะปััะธะปะธ **ะฟะพะปะฝะพัััั ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝัั ัะธััะตะผั** ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะดะพัััะฟะพะผ ัะพัััะดะฝะธะบะพะฒ ะบ VPN ั:

โ ะะฒัะพะผะฐัะธัะตัะบะพะน ะณะตะฝะตัะฐัะธะตะน WireGuard ะบะพะฝัะธะณะพะฒ  
โ ะัะฟัะฐะฒะบะพะน ะบะพะฝัะธะณะพะฒ ะฟะพ email  
โ ะฃะฟัะฐะฒะปะตะฝะธะตะผ ะดะพัััะฟะพะผ (enable/disable)  
โ REST API ะดะปั ะธะฝัะตะณัะฐัะธะธ  
โ ะะพะปะฝะพะน ะธััะพัะธะตะน ะฐัะดะธัะฐ  
โ ะัะพัััะผ PowerShell ะธะฝัะตััะตะนัะพะผ  

**ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฟััะผะพ ัะตะนัะฐั!**

ะะฐัะฐ: 2026-01-01  
ะะตััะธั: 1.0  
ะกัะฐััั: โ ะะพัะพะฒะพ ะบ production
