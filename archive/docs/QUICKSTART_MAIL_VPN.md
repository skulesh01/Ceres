# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø—Ä–æ–µ–∫—Ç:

### üìß **Mailu** - –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
- **–í–µ–±-–∞–¥–º–∏–Ω–∫–∞**: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—á—Ç–æ–≤—ã—Ö —è—â–∏–∫–æ–≤ @ceres.local
- **Roundcube Webmail**: –ß—Ç–µ–Ω–∏–µ –ø–æ—á—Ç—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- **SMTP/IMAP**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—á—Ç–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–î–æ—Å—Ç—É–ø**: https://mail.ceres.local

### üîí **wg-easy** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ VPN —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –°–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ VPN –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **QR-–∫–æ–¥—ã**: –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤**: –û–¥–∏–Ω –∫–ª–∏–∫
- **–î–æ—Å—Ç—É–ø**: https://vpn.ceres.local

---

## üéØ –°–¶–ï–ù–ê–†–ò–ô 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤—Ä—É—á–Ω—É—é

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://mail.ceres.local
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
   - Email: `admin@ceres.local`
   - –ü–∞—Ä–æ–ª—å: `admin123` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Users** ‚Üí **Add User**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - Email: `ivan.petrov@ceres.local`
   - Password: `SecurePass123`
   - Display Name: `–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤`
   - Quota: `1 GB`
5. –ù–∞–∂–º–∏—Ç–µ **Create**

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ VPN –¥–æ—Å—Ç—É–ø
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://vpn.ceres.local
2. –í–æ–π–¥–∏—Ç–µ —Å –ø–∞—Ä–æ–ª–µ–º: `admin` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
3. –ù–∞–∂–º–∏—Ç–µ **+ New Client**
4. –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞: `ivan.petrov`
5. –ù–∞–∂–º–∏—Ç–µ **Create**
6. **–°–∫–∞—á–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥** –∏–ª–∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥

### –®–∞–≥ 3: –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://mail.ceres.local/webmail
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ admin@ceres.local
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–∏—Å—å–º–æ –¥–ª—è ivan.petrov@ceres.local
4. –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π .conf —Ñ–∞–π–ª
5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é

**–ì–û–¢–û–í–û!** ‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–æ–ª—É—á–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–≤–æ—é –ø–æ—á—Ç—É.

---

## ü§ñ –°–¶–ï–ù–ê–†–ò–ô 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ (PowerShell)

### –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–µ–ª–∞–µ—Ç –≤—Å—ë:
```powershell
cd scripts
.\create-employee.ps1 `
  -Username "ivan.petrov" `
  -FullName "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω –°–µ—Ä–≥–µ–µ–≤–∏—á" `
  -Password "SecurePass123"
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –°–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ ivan.petrov@ceres.local
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—É—é –ø–æ—á—Ç—É
- ‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–æ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```powershell
# –° —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤ Keycloak SSO
.\create-employee.ps1 -Username "maria" -FullName "–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞" -Password "Pass1234" -CreateKeycloak

# –°–≤–æ–π –¥–æ–º–µ–Ω
.\create-employee.ps1 -Username "alex" -FullName "Alex Smith" -Password "Pass1234" -Domain "company.com"
```

---

## üåê –†–ê–ó–í–Å–†–¢–´–í–ê–ù–ò–ï: –ó–∞–ø—É—Å–∫ –ø–æ—á—Ç—ã –∏ VPN

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë —Å—Ä–∞–∑—É
```powershell
cd scripts
.\start.ps1 core apps mail vpn edge
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –¢–æ–ª—å–∫–æ –ø–æ—á—Ç–∞ –∏ VPN
```powershell
cd config
docker compose -f compose/base.yml -f compose/core.yml -f compose/mail.yml -f compose/vpn.yml -f compose/edge.yml up -d
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
```powershell
docker compose -f compose/mail.yml ps
docker compose -f compose/vpn.yml ps
```

---

## üîë –î–û–°–¢–£–ü–´ –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ

### Mailu (–ü–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä)
- URL: https://mail.ceres.local
- –ê–¥–º–∏–Ω: admin@ceres.local
- –ü–∞—Ä–æ–ª—å: admin123
- Webmail: https://mail.ceres.local/webmail

### wg-easy (VPN)
- URL: https://vpn.ceres.local
- –ü–∞—Ä–æ–ª—å: admin

### Keycloak (SSO)
- URL: https://auth.ceres.local
- –ê–¥–º–∏–Ω: admin
- –ü–∞—Ä–æ–ª—å: admin123

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞!

---

## üìã WORKFLOW: –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞

### –ù–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫:
```
1. –°–æ–∑–¥–∞—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ (mail.ceres.local)
   ‚îî‚îÄ> ivan.petrov@ceres.local

2. –°–æ–∑–¥–∞—Ç—å VPN –¥–æ—Å—Ç—É–ø (vpn.ceres.local)
   ‚îî‚îÄ> –°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ ivan.petrov.conf

3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ –ø–æ—á—Ç—É
   ‚îî‚îÄ> –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–æ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

4. –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è:
   ‚îú‚îÄ> –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç WireGuard
   ‚îú‚îÄ> –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥
   ‚îú‚îÄ> –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç VPN
   ‚îî‚îÄ> –ü–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ä–µ—Å—É—Ä—Å–∞–º
```

### –£–≤–æ–ª—å–Ω–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:
```
1. –£–¥–∞–ª–∏—Ç—å VPN –∫–ª–∏–µ–Ω—Ç–∞ (vpn.ceres.local)
   ‚îî‚îÄ> –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ç–∏ –æ—Ç–∫–ª—é—á—ë–Ω ‚ùå

2. –û—Ç–∫–ª—é—á–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ (mail.ceres.local)
   ‚îî‚îÄ> –ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ disabled

3. –û—Ç–æ–∑–≤–∞—Ç—å SSO (auth.ceres.local)
   ‚îî‚îÄ> –£–¥–∞–ª–∏—Ç—å –∏–∑ Keycloak
```

---

## üõ†Ô∏è –ù–ê–°–¢–†–û–ô–ö–ê: –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

### 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–§–∞–π–ª: `config/.env`

```bash
# –î–æ–º–µ–Ω
DOMAIN=ceres.local

# Mailu
MAILU_SECRET_KEY=ChangeThisSecretKey123456789012
MAIL_DOMAIN=ceres.local
MAILU_ADMIN_PASSWORD=admin123

# WireGuard
WG_HOST=your-public-ip-or-domain
WG_EASY_PASSWORD_HASH=<generated-hash>
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
-- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
docker exec -it ceres-postgres-1 psql -U postgres

-- –°–æ–∑–¥–∞–π—Ç–µ –ë–î –¥–ª—è Mailu
CREATE DATABASE mailu;
CREATE DATABASE roundcube;
GRANT ALL PRIVILEGES ON DATABASE mailu TO postgres;
GRANT ALL PRIVILEGES ON DATABASE roundcube TO postgres;
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã
```powershell
cd config
docker compose -f compose/base.yml -f compose/core.yml -f compose/mail.yml -f compose/vpn.yml -f compose/edge.yml up -d
```

### 4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker compose -f compose/mail.yml logs -f mailu-admin
docker compose -f compose/vpn.yml logs -f wg-easy

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å "Up")
docker compose -f compose/mail.yml ps
```

### 5. –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥
1. https://mail.ceres.local ‚Üí –≤–æ–π—Ç–∏ –∫–∞–∫ admin@ceres.local
2. https://vpn.ceres.local ‚Üí –≤–æ–π—Ç–∏ —Å –ø–∞—Ä–æ–ª–µ–º admin

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –õ–æ–≥–∏ –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:
```powershell
docker compose -f compose/mail.yml logs -f mailu-smtp
docker compose -f compose/mail.yml logs -f mailu-imap
```

### –õ–æ–≥–∏ VPN:
```powershell
docker compose -f compose/vpn.yml logs -f wg-easy
```

### –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö VPN –∫–ª–∏–µ–Ω—Ç–æ–≤:
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ WireGuard
docker exec wg-easy wg show
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—á—Ç—ã:
- –û—Ç–∫—Ä–æ–π—Ç–µ https://mail.ceres.local
- **Dashboard** ‚Üí —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö/–ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º

---

## üî• TROUBLESHOOTING

### –ü–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è
```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose -f compose/mail.yml logs mailu-admin

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î
docker exec -it ceres-postgres-1 psql -U postgres -d mailu -c "SELECT * FROM users;"
```

### VPN –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç 51820/UDP –æ—Ç–∫—Ä—ã—Ç –≤ firewall
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ WG_HOST –≤ .env (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π IP)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose -f compose/vpn.yml logs wg-easy`

### Email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SMTP —Å–µ—Ä–≤–∏—Å
docker compose -f compose/mail.yml logs mailu-smtp

# –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
docker exec -it mailu-smtp-1 telnet localhost 25
```

---

## üéØ –ò–¢–û–ì

**–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å:**
‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–æ—á—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä —Å –≤–µ–±-–∞–¥–º–∏–Ω–∫–æ–π
‚úÖ VPN —Å —É–¥–æ–±–Ω—ã–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ—á—Ç—ã + VPN + Keycloak

**–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä!**
- https://mail.ceres.local - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—á—Ç–æ–π
- https://vpn.ceres.local - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ VPN
- https://auth.ceres.local - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**–ù–∞—á–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É:**
```powershell
# –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
.\scripts\create-employee.ps1 -Username "test" -FullName "Test User" -Password "Test1234"
```

üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
